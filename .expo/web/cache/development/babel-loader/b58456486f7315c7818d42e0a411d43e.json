{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\MOBOMEDIA\\\\mobotcmsdemo\\\\Frontendtech\\\\reactnative\\\\story\\\\TechVlog\\\\components\\\\auth.js\";\nimport React, { useEffect, useState } from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport * as AppAuth from 'expo-app-auth';\nexport default function Auth() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      authState = _useState2[0],\n      setAuthState = _useState2[1];\n\n  useEffect(function () {\n    (function _callee() {\n      var cachedAuth;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(getCachedAuthAsync());\n\n            case 2:\n              cachedAuth = _context.sent;\n\n              if (cachedAuth && !authState) {\n                setAuthState(cachedAuth);\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n  return React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 13\n    }\n  }, \"Expo AppAuth Example\"), React.createElement(Button, {\n    title: \"Sign In with Google \",\n    onPress: function _callee2() {\n      var _authState;\n\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(signInAsync());\n\n            case 2:\n              _authState = _context2.sent;\n              setAuthState(_authState);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 13\n    }\n  }), React.createElement(View, {\n    style: styles.mtop,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Sign Out \",\n    onPress: function _callee3() {\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(signOutAsync(authState));\n\n            case 2:\n              setAuthState(null);\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 13\n    }\n  })), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 13\n    }\n  }, JSON.stringify(authState, null, 2)));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  mtop: {\n    marginTop: 50\n  }\n});\nvar config = {\n  issuer: 'https://accounts.google.com',\n  scopes: ['openid', 'profile'],\n  clientId: '603386649315-vp4revvrcgrcjme51ebuhbkbspl048l9.apps.googleusercontent.com'\n};\nvar StorageKey = '@MyApp:CustomGoogleOAuthKey';\nexport function signInAsync() {\n  var authState;\n  return _regeneratorRuntime.async(function signInAsync$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return _regeneratorRuntime.awrap(AppAuth.authAsync(config));\n\n        case 2:\n          authState = _context4.sent;\n          _context4.next = 5;\n          return _regeneratorRuntime.awrap(cacheAuthAsync(authState));\n\n        case 5:\n          console.log('signInAsync', authState);\n          return _context4.abrupt(\"return\", authState);\n\n        case 7:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nfunction cacheAuthAsync(authState) {\n  return _regeneratorRuntime.async(function cacheAuthAsync$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem(StorageKey, JSON.stringify(authState)));\n\n        case 2:\n          return _context5.abrupt(\"return\", _context5.sent);\n\n        case 3:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nexport function getCachedAuthAsync() {\n  var value, authState;\n  return _regeneratorRuntime.async(function getCachedAuthAsync$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.next = 2;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem(StorageKey));\n\n        case 2:\n          value = _context6.sent;\n          authState = JSON.parse(value);\n          console.log('getCachedAuthAsync', authState);\n\n          if (!authState) {\n            _context6.next = 11;\n            break;\n          }\n\n          if (!checkIfTokenExpired(authState)) {\n            _context6.next = 10;\n            break;\n          }\n\n          return _context6.abrupt(\"return\", refreshAuthAsync(authState));\n\n        case 10:\n          return _context6.abrupt(\"return\", authState);\n\n        case 11:\n          return _context6.abrupt(\"return\", null);\n\n        case 12:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nfunction checkIfTokenExpired(_ref) {\n  var accessTokenExpirationDate = _ref.accessTokenExpirationDate;\n  return new Date(accessTokenExpirationDate) < new Date();\n}\n\nfunction refreshAuthAsync(_ref2) {\n  var refreshToken, authState;\n  return _regeneratorRuntime.async(function refreshAuthAsync$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          refreshToken = _ref2.refreshToken;\n          _context7.next = 3;\n          return _regeneratorRuntime.awrap(AppAuth.refreshAsync(config, refreshToken));\n\n        case 3:\n          authState = _context7.sent;\n          console.log('refreshAuth', authState);\n          _context7.next = 7;\n          return _regeneratorRuntime.awrap(cacheAuthAsync(authState));\n\n        case 7:\n          return _context7.abrupt(\"return\", authState);\n\n        case 8:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nexport function signOutAsync(_ref3) {\n  var accessToken;\n  return _regeneratorRuntime.async(function signOutAsync$(_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          accessToken = _ref3.accessToken;\n          _context8.prev = 1;\n          _context8.next = 4;\n          return _regeneratorRuntime.awrap(AppAuth.revokeAsync(config, {\n            token: accessToken,\n            isClientIdProvided: true\n          }));\n\n        case 4:\n          _context8.next = 6;\n          return _regeneratorRuntime.awrap(AsyncStorage.removeItem(StorageKey));\n\n        case 6:\n          return _context8.abrupt(\"return\", null);\n\n        case 9:\n          _context8.prev = 9;\n          _context8.t0 = _context8[\"catch\"](1);\n          alert(\"Failed to revoke token: \" + _context8.t0.message);\n\n        case 12:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, null, null, [[1, 9]], Promise);\n}","map":{"version":3,"sources":["C:/Users/Admin/Desktop/MOBOMEDIA/mobotcmsdemo/Frontendtech/reactnative/story/TechVlog/components/auth.js"],"names":["React","useEffect","useState","AsyncStorage","AppAuth","Auth","authState","setAuthState","getCachedAuthAsync","cachedAuth","signInAsync","_authState","styles","mtop","signOutAsync","JSON","stringify","StyleSheet","create","container","flex","backgroundColor","alignItems","justifyContent","marginTop","config","issuer","scopes","clientId","StorageKey","authAsync","cacheAuthAsync","console","log","setItem","getItem","value","parse","checkIfTokenExpired","refreshAuthAsync","accessTokenExpirationDate","Date","refreshToken","refreshAsync","accessToken","revokeAsync","token","isClientIdProvided","removeItem","alert","message"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Button, StyleSheet, Text, View } from 'react-native';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport * as AppAuth from 'expo-app-auth';\r\n\r\nexport default function Auth() {\r\n    let [authState, setAuthState] = useState(null);\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            let cachedAuth = await getCachedAuthAsync();\r\n            if (cachedAuth && !authState) {\r\n                setAuthState(cachedAuth);\r\n            }\r\n        })();\r\n    }, []);\r\n\r\n    return (\r\n        <View>\r\n            <Text>Expo AppAuth Example</Text>\r\n            <Button\r\n                title=\"Sign In with Google \"\r\n                onPress={async () => {\r\n                    const _authState = await signInAsync();\r\n                    setAuthState(_authState);\r\n                }}\r\n            />\r\n            <View style={styles.mtop}> \r\n            <Button \r\n                title=\"Sign Out \"\r\n                onPress={async () => {\r\n                    await signOutAsync(authState);\r\n                    setAuthState(null);\r\n                }}\r\n            />\r\n            </View>\r\n         \r\n            <Text>{JSON.stringify(authState, null, 2)}</Text>\r\n        </View>\r\n    );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n    },\r\n    mtop: {\r\n        marginTop: 50\r\n    }\r\n});\r\n\r\nlet config = {\r\n    issuer: 'https://accounts.google.com',\r\n    scopes: ['openid', 'profile'],\r\n    /* This is the CLIENT_ID generated from a Firebase project */\r\n    clientId: '603386649315-vp4revvrcgrcjme51ebuhbkbspl048l9.apps.googleusercontent.com',\r\n};\r\n\r\nlet StorageKey = '@MyApp:CustomGoogleOAuthKey';\r\n\r\nexport async function signInAsync() {\r\n    let authState = await AppAuth.authAsync(config);\r\n    await cacheAuthAsync(authState);\r\n    console.log('signInAsync', authState);\r\n    return authState;\r\n}\r\n\r\nasync function cacheAuthAsync(authState) {\r\n    return await AsyncStorage.setItem(StorageKey, JSON.stringify(authState));\r\n}\r\n\r\nexport async function getCachedAuthAsync() {\r\n    let value = await AsyncStorage.getItem(StorageKey);\r\n    let authState = JSON.parse(value);\r\n    console.log('getCachedAuthAsync', authState);\r\n    if (authState) {\r\n        if (checkIfTokenExpired(authState)) {\r\n            return refreshAuthAsync(authState);\r\n        } else {\r\n            return authState;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction checkIfTokenExpired({ accessTokenExpirationDate }) {\r\n    return new Date(accessTokenExpirationDate) < new Date();\r\n}\r\n\r\nasync function refreshAuthAsync({ refreshToken }) {\r\n    let authState = await AppAuth.refreshAsync(config, refreshToken);\r\n    console.log('refreshAuth', authState);\r\n    await cacheAuthAsync(authState);\r\n    return authState;\r\n}\r\n\r\nexport async function signOutAsync({ accessToken }) {\r\n    try {\r\n        await AppAuth.revokeAsync(config, {\r\n            token: accessToken,\r\n            isClientIdProvided: true,\r\n        });\r\n        await AsyncStorage.removeItem(StorageKey);\r\n        return null;\r\n    } catch (e) {\r\n        alert(`Failed to revoke token: ${e.message}`);\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}